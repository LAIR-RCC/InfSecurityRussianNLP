Кто такой Gemalto? Как взломали Gemalto? Мы этого не знаем, но у нас есть официальный пресс-релиз , из которого ясно что: 1. Gemalto точно взломали 2. Офис Gemalto "прослушивался", кто-то пытался получить физический доступ к ноутбукам сотрудников 3. Что ещё более важно, у нас есть подтверждение того, что злоумышленники использовали Gemalto для атаки на клиентов компании, среди которых банки, операторы связи и государственные компании (производители биометрических паспортов, к примеру). А что если им это удалось? Из документов Сноудена мы знаем, что: 1. GCHQ изучало учетки Facebook сотрудников Gemalto 2. GCHQ перехватывало личные переговоры польских сотрудников Gemalto 3. GCHQ собирали и анализировали почтовые сессии Gemalto, ломали слабое шифрование FTP Общий вывод: GCHQ активно пыталось взломать Gemalto и вероятно добилось успеха. Кроме того конечной целью операции GCHQ являлись клиенты Gemalto. Ресурсы Gemalto были использованы для атак на её клиентов. А что если Gemalto встроили backdoor (bugdoor) в EMV? http://www.gemalto.com/emv Gemalto - крупнейший производитель EMV чипов в мире. Официально Gemalto отрицает возможность компрометации производства EMV, и в презенташках GCHQ про EMV ни слова. Но: Упрощенно схема операций по EMV картам выглядит так: Ассиметрическая криптография в EMV чипах непопулярна, так как требует много мозгов и памяти, взять которых чипу негде. Поэтому используется 3DES c жестко зашитым Центром Подготовки Карт ключом, который генерируется обычно из Мастер-ключа и счёта пользователя. При валидации транзакции происходит обратный процесс. Таким образом надежность всей схемы определяется секретностью Мастер-ключа. Мастер-ключ хранится в HSM модуле Card Preparation System - Центра Подготовки Карт (большого принтера карточек). CPS может быть как своим, так и арендуемым у третьей стороны. Процесс генерации, записи и передачи Мастер-ключа в Авторизационный центр достаточно хорошо регламентирован и защищён (по крайней мере в теории). Но и тут есть несколько потенциально уязвимых мест: 1. Оборудование для Card Personalisation Centre производит... правильно, Gemalto :). Мастер-ключ может быть извлечен на этапе ввода в CPS систему или через HSM 2. EMV чип может быть забэкдорен (забагдорен) для извлечения ключа карты 3. Мастер-ключ может быть украден (или подменен!) на этапе переноса его в Авторизационный центр. 4. АНБ, в конце концов, может ослабить генератор случайных чисел или KDF алгоритмы, используемые системой. Может забэкдорить прошивки CPS, HSM и EMV Java приложения (или SDK для разработки EMV Java апплетов...) Какова реакция на взлом Gemalto? Ну этим боятся нечего. У них симкарты с НОВОГО ЗАВОДА, которого нет в презенташке Сноудена. У этих все сертифицировано, враг не пройдёт! Вы все врете! Везде заговор и Сноуден ненастоящий! Ну мы все равно пошлем запрос... А вдруг правда... Сегодня никто уже не воспринимает сотовую связь как конфиденциальный канал связи, поэтому ни пользователи ни операторы ничего делать из-за взлома Gemalto не будут :( Есть только несколько нюансов: 1. Gemalto говорит, что 3G сети не подвержены уязвимости, так как используют сессионные ключи. Однако сегодня сотовые сети часто работают в режиме LTE + 2G. LTE используется для интернета, а при звонке оператор перекидывает вас на дешевую 2G соту, которую можно слушать. 2. Silent (Stealth) SMS позволяют отслеживать ваши перемещения без вашего ведома. Именно для этого GCHQ ломало билинговые сервера (см. слайд вначале статьи). 3. Современная SIM карта - это полноценная среда со своей памятью, микропроцессором, приложениями и возможностью удалённой установки программ. Имея доступ к этой среде, существует возможность удаленной компрометации Android, iOS, Windows Mobile, так как их модель безопасности построена на доверии к приложениям симкарты. Проекты Gemalto 1. Вся продукция Aladdin-rd, в том числе eToken ГОСТ и симкарты с электронной подписью Универсальные карты для идентификации и оплаты всего-всего И многое многое другое.. Выводы Взломы происходят сейчас постоянно, и мы к ним привыкли. Современные системы обновлений делают все возможное для того, чтобы наше "окно беззащитности" сужалось до нескольких часов или минут с момента опубликования информации об уязвимости. Но совсем другое дело - это аппаратные крипточипы. Пропатчить их зачастую невозможно. Если мы обнаружим серьезную уязвимость или бэкдор в EMV чипе - миллиарды банковских карт станут моментально уязвимы без какой-либо возможности эту уязвимость закрыть. Процесс "патчинга" (то есть физической замены) крипточипов может занять годы и стоить миллиарды. На месте журналистов, я бы презенташку Сноудена про взлом EMV не выкладывал :) Карты с биометрической аутентификацией через JAVA приложение на EMV чипе