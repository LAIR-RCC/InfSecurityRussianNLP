Теги: Microsoft, уязвимость, IIS Уязвимость в Microsoft IIS может позволить злоумышленнику получить доступ к некоторым данным на сервере. В понедельник мы опубликовали уведомление безопасности для уязвимости в Microsoft IIS. Уязвимость в Microsoft IIS может позволить злоумышленнику получить доступ к некоторым данным на сервере. Уязвимости подвержен IIS версий 5, 5.1 и 6. Описание уязвимости: Уязвимость существует из-за ошибки при обработке WebDAV запросов к директориям, требуемым аутентификацию. Удаленный пользователь может с помощью специально сформированного HTTP GET запроса, содержащего Unicode символы и "Translate: f" HTTP заголовок, обойти ограничения безопасности и, например, скачать файлы с защищенных каталогов. Удачная эксплуатация уязвимости также может позволить загрузку произвольных файлов в защищенные WebDAV каталоги. Уязвимости подвержена только определенная конфигурация IIS. Сначала мы перечислим конфигурации, которые не подвержены уязвимости: На IIS сервере не используется WebDAV. В Windows Server 2003 IIS (версия 6) WebDAV отключен по умолчанию. IIS сервер не использует IIS привилегии для ограничения доступа аутентифицированным пользователям IIS сервер не предоставляет доступ к файловой системе для учетной записи IUSR_[Имя системы] IIS сервер, на котором находятся Web приложения, использующие аутентификацию, основанную на формах Уязвимой конфигурация считается, если : IIS 5, 5.1 или 6 использует WebDAV IIS сервер использует IIS привилегии для ограничения доступа к файлам или каталогам для аутентифицированных пользователей Доступ к файловой системе предоставлен учетной записи IUSR_[Имя системы] Родительский каталог для защищенной папки разрешен для доступа анонимным пользователям. Если настройки вашего сервера соответствуют всем пунктам, перечисленным в уязвимой конфигурации, анонимный удаленный пользователь может воспользоваться уязвимость для получения файлов, которые обычно доступны только аутентифицированным пользователям. Временное решение Microsoft разработала несколько вариантов по устранению уязвимости, до выхода официального исправления. Вариант 1: Отключение WebDAV Если вы не используете WebDAV, то самым правильным вариантом было бы его отключение. Для того, чтобы отключить WebDAV необходимо выполнить следующие действия: Перейдите к ключу HKEY_LOCAL_MACHINESYSTEMCurrentControlSetServicesW3SVCParameters Добавьте параметр: Value name: DisableWebDAV Data type: DWORD Value data: 1 Перезагрузите IIS. Более подробно о том, как отключить WebDAV можно прочитать по адресу: http://support.microsoft.com/kb/241520 Вариант 2: измените списки контроля доступа для запрета доступа для учетной записи IUSR_[Имя системы] Не забывайте, что используются 2 уровня привилегий для файлов, которые обрабатываются IIS. Первое пользователю доступ должен быть предоставлен файловой системой NTFS, и только после этого осуществляется проверка доступа в метаданных IIS. Если вы запретите доступ к серверу для анонимной учетной записи (IUSR_[Имя системы]), злоумышленник не сможет воспользоваться этой уязвимостью. Более подробно об ограничении доступа можно прочитать по адресу: http://support.microsoft.com/kb/271071 Вариант 3: блокирование доступа с помощью URLScan URLScan может предотвратить попытки эксплуатации уязвимости. Более подробно об использовании URLScan можно прочитать по адресу: http://technet.microsoft.com/en-us/security/cc242650.aspx SecurityLab рекомендует воспользоваться один из предложенных решений для временного устранения уязвимости до выхода официального исправления от производителя.